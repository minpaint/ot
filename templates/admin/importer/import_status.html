{% extends "admin/base_site.html" %}
{% load i18n %}

{% block content %}
    <div class="import-status-container">
        <h1>Статус импорта</h1>

        <div class="status-details">
            <p>
                <strong>Статус:</strong>
                <span class="status-badge status-{{ import_session.status }}">
                    {{ import_session.get_status_display }}
                </span>
            </p>

            <p>
                <strong>Прогресс:</strong>
                {{ import_session.processed_rows }} из {{ import_session.total_rows }}
            </p>

            {% if import_session.errors %}
                <div class="error-list">
                    <h3>Ошибки импорта:</h3>
                    <ul>
                        {% for error in import_session.errors.errors %}
                            <li>
                                <strong>Строка {{ error.row }}:</strong>
                                {{ error.error }}
                                <pre>{{ error.data|pprint }}</pre>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
            {% endif %}
        </div>

        <div class="actions">
            <a href="{% url 'importer:import-form' %}" class="button">
                Новый импорт
            </a>
            {% if import_session.status == 'failed' %}
                <a href="{% url 'importer:retry-import' import_session.id %}" 
                   class="button default">
                    Повторить импорт
                </a>
            {% endif %}
        </div>
    </div>
{% endblock %}